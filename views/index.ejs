<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='utf-8' />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.14.0/jquery-ui.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>
</head>
<body>
    <%if (!isLoggedIn) { %>
        <a href="/login"><h3> LOGIN </h3></a>
        <a href="/register"><h3> REGISTER </h3></a>
        <% } %>
        <%if (isLoggedIn) { %>
            <a href="/logout"><h3> LOGOUT </h3></a>
            <a href="/profile"><h3> My Profile </h3></a>
            <%if (isAdmin) { %>
                <a href="/admin/"><h3> Admin </h3></a>
                <% } %>
                <% } %>
                <div id='calendar'></div>
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        var calendarEl = document.getElementById('calendar');
                        var calendar = new FullCalendar.Calendar(calendarEl, {
                            initialView: 'dayGridMonth',
                            timeZone:'America/Chicago',
                            dateClick: function(info) {
                                //alert('Clicked on: ' + info.dateStr);
                                //alert('Coordinates: ' + info.jsEvent.pageX + ',' + info.jsEvent.pageY);
                                //alert('Current view: ' + info.view.type);
                                if (info.date.getDay()==0){ //Blockout Mondays
                                    return;
                                }
                                else{
                                    var month = info.date.getUTCMonth()+1;
                                    var day = info.date.getUTCDate();
                                    var year = info.date.getUTCFullYear();
                                    window.location.href = '/newEvent/'+month+'/'+day+'/'+year;
                                }
                            },
                            events: {
                                url: '/events/getRange',
                                failure: function() {
                                    alert('there was an error while fetching events!');
                                }
                            },
                            dayCellDidMount: function (arg) { //Color background of Mondays
                                if (arg.dow == 1) {
                                    arg.el.bgColor="gray";
                                }
                            },
                            firstDay:1
                        });
                        calendar.render();
                    });
                </script>
            </body>
            </html>