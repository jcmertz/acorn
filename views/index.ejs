<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='utf-8' />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.14.0/jquery-ui.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>  
</head>
<body>
    <%if (!isLoggedIn) { %>
        <a href="/login"><h3> LOGIN </h3></a>
        <a href="/register"><h3> REGISTER </h3></a>
        <% } %>
        <%if (isLoggedIn) { %>
            <a href="/logout"><h3> LOGOUT </h3></a>
            <a href="/profile"><h3> My Profile </h3></a>
            <% } %>
            <div id='calendar'></div>
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    var calendarEl = document.getElementById('calendar');
                    var calendar = new FullCalendar.Calendar(calendarEl, {
                        initialView: 'dayGridMonth',
                        timeZone:'America/Chicago',
                        dateClick: function(info) {
                            if (info.date.getDay()==0){ //Blockout Mondays
                                return;
                            }
                            else{
                                var month = info.date.getUTCMonth()+1;
                                var day = info.date.getUTCDate();
                                var year = info.date.getUTCFullYear();
                                window.location.href = '/newEvent/'+month+'/'+day+'/'+year;
                            }
                        },
                        events: {
                            <%if (isAdmin) { %>
                                url: '/events/getRangeAdmin',
                                <% } else { %>
                                    url: '/events/getRange',
                                    <% } %>
                                    failure: function() {
                                        alert('there was an error while fetching events!');
                                    }
                                },
                                dayCellDidMount: function (arg) { //Color background of Mondays
                                    if (arg.dow == 1) {
                                        arg.el.bgColor="gray";
                                    }
                                },
                                firstDay:1
                            });
                            calendar.render();
                        });
                    </script>
                </body>
                </html>